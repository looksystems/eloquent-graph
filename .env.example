# Eloquent Cypher - Graph Database Configuration
# Version 2.0 - Driver Abstraction Layer

# =============================================================================
# Graph Database Connection
# =============================================================================

# Database driver type (currently supported: neo4j)
# Future: memgraph, apache-age
GRAPH_DATABASE_TYPE=neo4j

# Connection details
GRAPH_HOST=localhost
GRAPH_PORT=7687
GRAPH_DATABASE=neo4j
GRAPH_USERNAME=neo4j
GRAPH_PASSWORD=password

# Connection protocol (bolt, neo4j, neo4j+s, neo4j+ssc, bolt+s, bolt+ssc)
GRAPH_PROTOCOL=bolt

# =============================================================================
# Performance & Optimization
# =============================================================================

# Batch execution (improves bulk operations by 50-70%)
GRAPH_BATCH_SIZE=100
GRAPH_ENABLE_BATCH_EXECUTION=true

# Connection pooling
GRAPH_POOL_ENABLED=true
GRAPH_POOL_MAX_CONNECTIONS=10
GRAPH_POOL_MIN_CONNECTIONS=1
GRAPH_POOL_ACQUIRE_TIMEOUT=60000

# Lazy connection (defer connection until first query)
GRAPH_LAZY_CONNECTION=false

# =============================================================================
# Relationship Storage Strategy
# =============================================================================

# Default storage mode for relationships:
# - foreign_key: Traditional Eloquent (properties on nodes)
# - edge: Native Neo4j edges (relationships in graph)
# - hybrid: Both foreign keys AND edges (recommended for migration)
GRAPH_RELATIONSHIP_STORAGE=hybrid

# Automatically create edges when relationships are established
GRAPH_AUTO_CREATE_EDGES=true

# Edge naming convention for relationships
# Options: snake_case_upper (HAS_POSTS), camel_case (HasPosts), etc.
GRAPH_EDGE_NAMING_CONVENTION=snake_case_upper

# =============================================================================
# APOC & Advanced Features
# =============================================================================

# Use APOC plugin for enhanced JSON operations (optional)
# When enabled: Better performance for complex nested JSON queries
# When disabled: Falls back to string-based JSON matching
GRAPH_USE_APOC_FOR_JSON=true

# =============================================================================
# Retry & Error Handling
# =============================================================================

# Maximum retry attempts for transient errors
GRAPH_RETRY_MAX_ATTEMPTS=3

# Initial delay between retries (milliseconds)
GRAPH_RETRY_INITIAL_DELAY_MS=100

# Maximum delay between retries (milliseconds)
GRAPH_RETRY_MAX_DELAY_MS=5000

# Delay multiplier for exponential backoff
GRAPH_RETRY_MULTIPLIER=2.0

# Add random jitter to prevent thundering herd
GRAPH_RETRY_JITTER=true

# =============================================================================
# Read/Write Splitting (Enterprise Edition)
# =============================================================================

# Read preference: primary, secondary, nearest
GRAPH_READ_PREFERENCE=primary

# Read replica connection details (optional)
GRAPH_READ_HOST=
GRAPH_READ_PORT=
GRAPH_READ_USERNAME=
GRAPH_READ_PASSWORD=

# Write primary connection details (optional, uses main connection if not set)
GRAPH_WRITE_HOST=
GRAPH_WRITE_PORT=
GRAPH_WRITE_USERNAME=
GRAPH_WRITE_PASSWORD=

# =============================================================================
# Testing Configuration
# =============================================================================

# Test database connection (use different port to avoid conflicts)
GRAPH_TEST_HOST=localhost
GRAPH_TEST_PORT=7688
GRAPH_TEST_USERNAME=neo4j
GRAPH_TEST_PASSWORD=password

# =============================================================================
# Legacy Neo4j Variables (Backward Compatibility)
# =============================================================================
# These are deprecated but still supported for v1 â†’ v2 migration
# Will be removed in v3.0

NEO4J_HOST=localhost
NEO4J_PORT=7687
NEO4J_DATABASE=neo4j
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=password
NEO4J_RELATIONSHIP_STORAGE=hybrid
